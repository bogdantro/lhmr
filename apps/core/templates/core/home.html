{% extends 'core/base.html' %}
{% load static %}


{% block content %}
<link rel="stylesheet" href="{% static '/scss/base.css' %}" type="text/css">
<script rel="stylesheet" src="{% static '/js/home.js' %}" type="text/javascript"></script>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">


<div class="cover">
    <img src="{% static '/images/covers/cover-1.jpg' %}" id="cover-1" alt="cover-1">
    <div class="cover-content">
        <h1 class="cover-text" id="coverTxt">Få en profesjonell nettiside med Webiser</h1>
        <a onclick="pricesHome()"><button class="cover-btn" id="coverBtn">kom i gang</button></a>
    </div>
</div>
<div class="services">
   <div class="icon">
      <i class="fas fa-check"></i>
      <h1>Rask levering</h1>
   </div>
   <div class="icon">
      <i class="fas fa-users"></i>      
      <h1>Få 2 timer gratis hjelp hver uke</h1>
   </div>
   <div class="icon">
      <i class="fal fa-phone-laptop"></i>      
      <h1>Responsiv og modern design</h1>
   </div>
   <div class="icon">
      <i class="far fa-shield-check"></i>      
      <h1>Vi tar en backup av nettsiden, i tilfelle du mister den</h1>
   </div>
   <div class="icon">
      <i class="fab fa-python"></i>      
      <h1>Skrevet i python, enkelt å forstå</h1>
   </div>
   <div class="icon">
      <i class="fas fa-coins"></i>      
      <h1>Fleksible priser som passer til alle</h1>
   </div>
   <div class="border"></div>
</div>
<div class="product-section" id="productHomePage">
   <h1>Velg din plan</h1>
   {% for product in products %}
   <div class="product-card">
      <div class="text">
         <h1 class="product-name">{{product.name}}</h1>
         <h1 class="product-price">{{product.price|floatformat}} kr</h1>
      </div>
      <div class="border"></div>
      <div class="buttons-product-section">
         <a @click="addToCart({{ product.id }})" onclick="addToCartHomePage()" class="btn-buy">Bestill</a>
         <a href="{% url  'product_detail' product.slug  %}">Se detaljer</a>
      </div>
   </div>
   {% endfor %}
   <div class="border"></div>
</div>
<div class="contact-us" id="contactUs">
   <h1>Trenger du extra hjelp?</h1>
   <p>Kontakter oss under</p>
   <form method="post">
      {% csrf_token %}
      <label for="fra_epost">Din epost</label>
      <br>
      <input type="text" name="fra_epost">
      <br>
      <label for="navn">Din navn</label>
      <br>
      <input type="text" name="navn">
      <br>
      <label for="beskjed">Hva ønsker du fortelle oss?</label>
      <br>
      <textarea class="beskjed" type="text" name="beskjed" cols="30" rows="10"></textarea>
      <div class="form-actions">
         <button type="submit">Send</button>
      </div>
   </form>
</div>
{% endblock %}

{% block scripts %}
<script>
   const productHomePage = new Vue({
      el: '#productHomePage',
      delimeters: ['[[', ']]'],
      store: store,
      
      methods: {
         addToCart(product_id) {
            console.log('Product_id', product_id);

            const data = {
               'product_id': product_id, 
               'update': false,
               'quantity': 1
         };

            fetch('/api/add_to_cart/', {
               method: 'POST',
               headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': '{{ csrf_token }}'
               },
               credentials: 'same-origin',
               body: JSON.stringify(data)
            }) 
            .then((response) =>{
               console.log(response)
               
               store.commit('increment', 1);

            })
            .catch(function (error) {
               console.log('Error 2');
               console.log(error);
            })
         }
      }
   });
</script>
{% endblock %}
