{% extends 'core/base.html' %}
{% load static %}


{% block content %}
<link rel="stylesheet" href="{% static '/scss/base.css' %}" type="text/css">
<script rel="stylesheet" src="{% static '/js/home.js' %}" type="text/javascript"></script>
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">


<div class="cover">
    <img src="{% static '/images/covers/cover-1.jpg' %}" id="cover-1" alt="cover-1">
    <div class="cover-content">
        <h1 class="cover-text" id="coverTxt">F책 en profesjonell nettiside med Webiser</h1>
        <a onclick="pricesHome()"><button class="cover-btn" id="coverBtn">kom i gang</button></a>
    </div>
</div>
<div class="services">
   <div class="icon">
      <i class="fas fa-check"></i>
      <h1>Rask levering</h1>
   </div>
   <div class="icon">
      <i class="fas fa-users"></i>      
      <h1>F책 2 timer gratis hjelp hver uke</h1>
   </div>
   <div class="icon">
      <i class="fal fa-phone-laptop"></i>      
      <h1>Responsiv og modern design</h1>
   </div>
   <div class="icon">
      <i class="far fa-shield-check"></i>      
      <h1>Vi tar en backup av nettsiden, i tilfelle du mister den</h1>
   </div>
   <div class="icon">
      <i class="fab fa-python"></i>      
      <h1>Skrevet i python, enkelt 책 forst책</h1>
   </div>
   <div class="icon">
      <i class="fas fa-coins"></i>      
      <h1>Fleksible priser som passer til alle</h1>
   </div>
</div>
<div class="productSection" id="productHomePage">
   <br>
   {% for product in products %}
   <div class="card">
      <div class="desc">
          <h6 class="product-name">{{ product.name }}</h6>
          <h6 class="product-description">{{product.description}}</h6>
      </div>
      <div class="buy">
         <button @click="addToCart({{ product.id }})" onclick="addToCartHomePage()" class="btn-buy">Bestill</button>
         <button class="btn-details">Se detaljer</button>
      </div>
      <div class="price">
         <h6 class="product-price">{{ product.price|floatformat }} kr</h6>
      </div>
   </div>
   {% endfor %}
    <br>
</div>

{% endblock %}

{% block scripts %}
<script>
   const productHomePage = new Vue({
      el: '#productHomePage',
      delimeters: ['[[', ']]'],
      store: store,
      
      methods: {
         addToCart(product_id) {
            console.log('Product_id', product_id);

            const data = {
               'product_id': product_id, 
               'update': false,
               'quantity': 1
         };

            fetch('/api/add_to_cart/', {
               method: 'POST',
               headers: {
                  'Content-Type': 'application/json',
                  'X-CSRFToken': '{{ csrf_token }}'
               },
               credentials: 'same-origin',
               body: JSON.stringify(data)
            }) 
            .then((response) =>{
               console.log(response)

               setTimeout(function(){
                  store.commit('increment', 1);
               }, 500)

            })
            .catch(function (error) {
               console.log('Error 2');
               console.log(error);
            })
         }
      }
   });
</script>
{% endblock %}
